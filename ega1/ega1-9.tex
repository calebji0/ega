\section{Supplement on quasi-coherent sheaves}
\label{section:I.9}

\subsection{Tensor product of quasi-coherent sheaves}
\label{subsection:I.9.1}

\begin{proposition}[9.1.1]
\label{I.9.1.1}
\oldpage[I]{169}
Let $X$ be a prescheme (resp. a locally Noetherian prescheme). Let $\sh{F}$ and
$\sh{G}$ be quasi-coherent (resp. coherent) $\sh{O}_X$-modules; then
$\sh{F}\otimes_{\sh{O}_X}\sh{G}$ is quasi-coherent (resp. coherent); it is further
of finite type if both $\sh{F}$ and $\sh{G}$ are of finite type. If
$\sh{F}$ admits a finite presentation and if $\sh{G}$ is quasi-coherent
(resp. coherent), then $\shHom(\sh{F},\sh{G})$ is quasi-coherent
(resp. coherent).
\end{proposition}

\begin{proof}
Being a local proposition, we can suppose that $X$ is affine (resp. Noetherian
affine); further, if $\sh{F}$ is coherent, then we can assume that it is the
cokernel of a homomorphism $\sh{O}_X^m\to\sh{O}_X^n$. The claims pertaining to
quasi-coherent sheaves then follow from Corollaries~\sref{I.1.3.12} and \sref{I.1.3.9}; the
claims pertaining to coherent sheaves follow from Theorem~\sref{I.1.5.1} and from the fact
that if $M$ and $N$ are modules of finite type over a Noetherian ring $A$
then $M\otimes_A N$ and $\Hom_A(M,N)$ are both $A$-modules of finite type.
\end{proof}

\begin{definition}[9.1.2]
\label{I.9.1.2}
Let $X$ and $Y$ be $S$-preschemes, $p$ and
$q$ the projections of $X\times_S Y$, and $\sh{F}$ (resp.$\sh{G}$) a
quasi-coherent $\sh{O}_X$-module (resp. quasi-coherent $\sh{O}_Y$-module). We define the
tensor product of $\sh{F}$ and $\sh{G}$ over $\sh{O}_S$ (\emph{or} over $S$),
denoted by $\sh{F}\otimes_{\sh{O}_S}\sh{G}$
(\emph{or} $\sh{F}\otimes_S\sh{G}$) to be the tensor product
$p^*(\sh{F})\otimes_{\sh{O}_{X\times_S Y}}q^*(\sh{G})$ over the prescheme $X\times_S Y$.
\end{definition}

If $X_i$ ($1\leq i\leq n$) are $S$-preschemes, and $\sh{F}_i$ ($1\leq i\leq n$) are quasi-coherent
$\sh{O}_{X_i}$-modules, then we similarly define the tensor product
$\sh{F}_1\otimes_S\sh{F}_2\otimes_S\cdots\otimes_S\sh{F}_n$ over the
prescheme $Z=X_1\times_S X_2\times_S\cdots\times_S X_n$; it is a
\emph{quasi-coherent} $\sh{O}_Z$-module by virtue of \sref{I.9.1.1} and
\sref[0]{0.5.1.4}; it is further \emph{coherent} if all the $\sh{F}_i$ are coherent \emph{and}
$Z$ is \emph{locally Noetherian}, by virtue of \sref{I.9.1.1},
\sref[0]{0.5.3.11}, and \sref{I.6.1.1}.

Note that, if we take $X=Y=S$, then Definition~\sref{I.9.1.2} gives us back the tensor
product of $\sh{O}_S$-modules. Furthermore, since $q^*(\sh{O}_Y)=\sh{O}_{X\times_S Y}$
\sref[0]{0.4.3.4}, the product $\sh{F}\otimes_S\sh{O}_Y$ is canonically
identified with $p^*(\sh{F})$, and, in the same way,
$\sh{O}_X\otimes_S\sh{G}$ is canonically identified with $q^*(\sh{G})$. In
particular, if we take $Y=S$ and denote by $f$ the structure morphism $X\to Y$,
then we have that $\sh{O}_X\otimes_Y\sh{G}=f^*(\sh{G})$: the ordinary tensor
product and the inverse image thus appear as particular cases of the general
tensor product.

Definition~\sref{I.9.1.2} leads immediately to the fact that, for fixed $X$ and
$Y$, $\sh{F}\otimes_S\sh{G}$ is a \emph{right-exact additive covariant bifunctor} in $\sh{F}$ and $\sh{G}$.

\begin{proposition}[9.1.3]
\label{I.9.1.3}
Let $S$, $X$, and $Y$ be affine schemes of rings
$A$, $B$, and $C$ (respectively), with $B$ and $C$ being $A$-algebras. Let $M$
(resp. $N$) be a $B$-module (resp. $C$-module), and
$\sh{F}=\widetilde{M}$ (resp. $\sh{G}=\widetilde{N}$) the
associated quasi-coherent sheaf; then $\sh{F}\otimes_S\sh{G}$ is
canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
$M\otimes_A N$.
\end{proposition}

\begin{proof}
\oldpage[I]{170}
According to Proposition~\sref{I.1.6.5}, $\sh{F}\otimes_S\sh{G}$
is canonically isomorphic to the sheaf associated to the $(B\otimes_A C)$-module
\[
  \big(M\otimes_B(B\otimes_A C)\big)\otimes_{B\otimes_A C}\big((B\otimes_A C)\otimes_C N\big)
\]
and, by the canonical isomorphisms between tensor products, this latter module is isomorphic to
\[
  M\otimes_B(B\otimes_A C)\otimes_C N=(M\otimes_B B)\otimes_A(C\otimes_C N)=M\otimes_A N.
\]
\end{proof}

\begin{proposition}[9.1.4]
\label{I.9.1.4}
Let $f:T\to X$ and $g:T\to Y$ be $S$-morphisms, and $\sh{F}$ (resp. $\sh{G}$) a quasi-coherent $\sh{O}_X$-module (resp. quasi-coherent $\sh{O}_Y$-module).
Then
\[
  (f,g)^*_S(\sh{F}\otimes_S\sh{G})=f^*(\sh{F})\otimes_{\sh{O}_T}g^*(\sh{G}).
\]
\end{proposition}

\begin{proof}
If $p$, $q$ are the projections of $X\times_S Y$, then the formula follows
from the equalities $(f,g)^*_S\circ p^*=f^*$ and
$(f,g)^*_S\circ q^*=g^*$ \sref[0]{0.3.5.5}, and the fact that the inverse
image of a tensor product of algebraic sheaves is the tensor product of their inverse
images \sref[0]{0.4.3.3}.
\end{proof}

\begin{corollary}[9.1.5]
\label{I.9.1.5}
Let $f:X\to X'$ and $g:Y\to Y'$ be
$S$-morphisms, and $\sh{F}'$ (resp. $\sh{G}'$) a quasi-coherent
$\sh{O}_{X'}$-module (resp. quasi-coherent $\sh{O}_{Y'}$-module). Then
\[
  (f,g)^*_S(\sh{F}'\otimes_S\sh{G}')=f^*(\sh{F}')\otimes_S g^*(\sh{G}')
\]
\end{corollary}

\begin{proof}
This follows from \sref{I.9.1.4} and the fact that $f\times_S g=(f\circ p, g\circ q)_S$,
where $p$ and $q$ are the projections of $X\times_S Y$.
\end{proof}

\begin{corollary}[9.1.6]
\label{I.9.1.6}
Let $X$, $Y$, and $Z$ be $S$-preschemes, and $\sh{F}$ (resp. $\sh{G}$, $\sh{H}$) a
quasi-coherent $\sh{O}_X$-module (resp. quasi-coherent $\sh{O}_Y$-module, quasi-coherent
$\sh{O}_Z$-module); then the sheaf $\sh{F}\otimes_S\sh{G}\otimes_S\sh{H}$ is the inverse image
of $(\sh{F}\otimes_S\sh{G})\otimes_S\sh{H}$ by the canonical isomorphism from
$X\times_S Y\times_S Z$ to $(X\times_S Y)\times_S Z$.
\end{corollary}

\begin{proof}
This isomorphism is given by $(p_1,p_2)_S\times_S p_3$, where $p_1$, $p_2$, and $p_3$
are the projections of $X\times_S Y\times_S Z$.

Similarly, the inverse image of $\sh{G}\otimes_S\sh{F}$ under the canonical isomorphism from
$X\times_S Y$ to $Y\times_S X$ is $\sh{F}\otimes_S\sh{G}$.
\end{proof}

\begin{corollary}[9.1.7]
\label{I.9.1.7}
If $X$ is an $S$-prescheme, then every quasi-coherent $\sh{O}_X$-module $\sh{F}$ is the inverse
image of $\sh{F}\otimes_S\sh{O}_S$ by the canonical isomorphism from $X$ to $X\times_S S$
\sref{I.3.3.3}.
\end{corollary}

\begin{proof}
This isomorphism is $(1_X,\vphi)_S$, where $\vphi$ is the structure morphism
$X\to S$, and the corollary follows from \sref{I.9.1.4} and the fact that
$\vphi^*(\sh{O}_S)=\sh{O}_X$.
\end{proof}

\begin{env}[9.1.8]
\label{I.9.1.8}
Let $X$ be an $S$-prescheme, $\sh{F}$ a quasi-coherent
$\sh{O}_X$-module, and $\vphi:S'\to S$ a morphism; we denote by
$\sh{F}_{(\vphi)}$ or $\sh{F}_{(S')}$ the quasi-coherent sheaf
$\sh{F}\otimes_S\sh{O}_{S'}$ over $X\times_S S'=X_{(\vphi)}=X_{(S')}$; so
$\sh{F}_{(S')}=p^*(\sh{F})$, where $p$ is the projection $X_{(S')}\to X$.
\end{env}

\begin{proposition}[9.1.9]
\label{I.9.1.9}
Let $\vphi'':S''\to S'$ be a morphism.
For every quasi-coherent $\sh{O}_X$-module $\sh{F}$ on the $S$-prescheme $X$,
$(\sh{F}_{(\vphi)})_{(\vphi')}$ is the inverse image of
$\sh{F}_{(\vphi\circ\vphi')}$ by the canonical isomorphism
$(X_{(\vphi)})_{(\vphi')}\isoto X_{(\vphi\circ\vphi')}$
\sref{I.3.3.9}.
\end{proposition}

\begin{proof}
This follows immediately from the definitions and from \sref{I.3.3.9}, and is
written
\[
\label{I.9.1.9.1}
  (\sh{F}\otimes_S\sh{O}_{S'})\otimes_{S'}\sh{O}_{S''}=\sh{F}\otimes_S\sh{O}_{S''}.
  \tag{9.1.9.1}
\]
\end{proof}

\begin{proposition}[9.1.10]
\label{I.9.1.10}
Let $Y$ be an $S$-prescheme, and $f:X\to Y$ an $S$-morphism.
For every quasi-coherent $\sh{O}_Y$-module $\sh{G}$ and every morphism
$S'\to S$, we have that
$(f_{(S')})^*(\sh{G}_{(S')})=(f^*(\sh{G}))_{(S')}$.
\end{proposition}

\begin{proof}
This follows immediately from the commutativity of the diagram
\oldpage[I]{171}
\[
  \xymatrix{
    X_{(S')}\ar[r]^{f_{(S')}}\ar[d] &
    Y_{(S')}\ar[d]\\
    X\ar[r]^f &
    Y.
  }
\]
\end{proof}

\begin{corollary}[9.1.11]
\label{I.9.1.11}
Let $X$ and $Y$ be $S$-preschemes, and
$\sh{F}$ (resp. $\sh{G}$) a quasi-coherent $\sh{O}_X$-module
(resp. quasi-coherent $\sh{O}_Y$-module). Then the inverse image of the sheaf
$(\sh{F}_{(S')})\otimes_{(S')}(\sh{G}_{(S')})$ by the canonical isomorphism
$(X\times_S Y)_{(S')}\isoto(X_{(S')})\times_{S'}(Y_{(S')})$
\sref{I.3.3.10} is equal to $(\sh{F}\otimes_S\sh{G})_{(S')}$.
\end{corollary}

\begin{proof}
If $p$ and $q$ are the projections of $X\times_S Y$, then the isomorphism in question
is nothing but $(p_{(S')}, q_{(S')})_{S'}$; the corollary then follows from
Propositions~\sref{I.9.1.4} and \sref{I.9.1.10}.
\end{proof}

\begin{proposition}[9.1.12]
\label{I.9.1.12}
With the notation from Definition~\sref{I.9.1.2}, let $z$ be
a point of $X\times_S Y$, and let $x=p(z)$, and $y=q(z)$; the stalk
$(\sh{F}\otimes_S\sh{G})_z$ is isomorphic to
$(\sh{F}_x\otimes_{\sh{O}_x}\sh{O}_z)\otimes_{\sh{O}_z}(\sh{G}_y\otimes_{\sh{O}_y}\sh{O}_z)
  =\sh{F}_x\otimes_{\sh{O}_x}\sh{O}_z\otimes_{\sh{O}_y}\otimes\sh{G}_y$.
\end{proposition}

\begin{proof}
Since we can reduce to the affine case, the proposition follows from
Equation~\sref{I.1.6.5.1}.
\end{proof}

\begin{corollary}[9.1.13]
\label{I.9.1.13}
If $\sh{F}$ and $\sh{G}$ are of finite type, then
\[
  \Supp(\sh{F}\otimes_S\sh{G})=p^{-1}(\Supp(\sh{F}))\cap q^{-1}(\Supp(\sh{G})).
\]
\end{corollary}

\begin{proof}
Since $p^*(\sh{F})$ and $q^*(\sh{G})$ are both of finite type over
$\sh{O}_{X\times_S Y}$, we reduce, by Proposition~\sref{I.9.1.12} and
by \sref[0]{0.1.7.5}, to the case where $\sh{G}=\sh{O}_Y$, that
is, it remains to prove the following equation:
\[
\label{I.9.1.13.1}
  \Supp(p^*(\sh{F}))=p^{-1}(\Supp(\sh{F})).
  \tag{9.1.13.1}
\]

The same reasoning as in \sref[0]{0.1.7.5} leads us to prove that, for all
$z\in X\times_S Y$, we have $\sh{O}_z/\mathfrak{m}_x\sh{O}_z\neq0$ (with $x=p(z)$),
which follows from the fact that the homomorphism $\sh{O}_x\to\sh{O}_z$ is \emph{local},
by hypothesis.
\end{proof}

We leave it to the reader to extend the results in this section to the more
general case of an arbitrary (but finite) number of factors, instead of just two.

\subsection{Direct image of a quasi-coherent sheaf}
\label{subsection:I.9.2}

\begin{proposition}[9.2.1]
\label{I.9.2.1}
Let $f:X\to Y$ be a morphism of
preschemes. We suppose that there exists a cover $(Y_\alpha)$ of $Y$ by affine
opens having the following property: every $f^{-1}(Y_\alpha)$ admits a
\emph{finite} cover $(X_{\alpha i})$ by affine opens that are contained in
$f^{-1}(Y_\alpha)$ and that are such that every intersection $X_{\alpha i}\cap X_{\alpha j}$
is itself a \emph{finite} union of affine opens. With these hypotheses, for
every quasi-coherent $\sh{O}_X$-module $\sh{F}$, $f_*(\sh{F})$ is a
quasi-coherent $\sh{O}_Y$-module.
\end{proposition}

\begin{proof}
Since this is a local condition on $Y$, we can assume that $Y$ is equal to one
of the $Y_\alpha$, and thus omit the indices $\alpha$.
\begin{enumerate}
  \item[(a)] First, suppose that the $X_i\cap X_j$
    are themselves \emph{affine} opens. We set $\sh{F}_i=\sh{F}|X_i$ and
    $\sh{F}_{ij}=\sh{F}|(X_i\cap X_j)$, and let $\sh{F}'_i$ and
    $\sh{F}'_{ij}$ be the images of $\sh{F}_i$ and $\sh{F}_{ij}$
    (respectively) by the restriction of $f$ to $X_i$ and to $X_i\cap X_j$
    (respectively); we know that the $\sh{F}'_i$ and $\sh{F}'_{ij}$ are
    quasi-coherent \sref{I.1.6.3}. Set $\sh{G}=\bigoplus_i\sh{F}'_i$ and
    $\sh{H}=\bigoplus_{i,j}\sh{F}'_{ij}$; $\sh{G}$ and $\sh{H}$ are
    quasi-coherent $\sh{O}_Y$-modules; we will define a homomorphism
    $u:\sh{G}\to\sh{H}$ such that $f_*(\sh{F})$ is the
    \emph{kernel} of $u$; it will follow from this that $f_*(\sh{F})$ is
    quasi-coherent \sref{I.1.3.9}. It suffices to define $u$ as
\oldpage[I]{172}
    a homomorphism of presheaves; taking into account the definitions of $\sh{G}$
    and $\sh{H}$, it thus suffices, for every open subset $W\subset Y$, to define a
    homomorphism
    \[
      u_W:\bigoplus_i\Gamma(f^{-1}(W)\cap X_i,\sh{F})\to\bigoplus_{i,j}\Gamma(f^{-1}(W)\cap X_i\cap X_j,\sh{F})
    \]
    that satisfies the usual compatibility conditions when we let $W$ vary.
    If, for every section $s_i\in\Gamma(f^{-1}(W)\cap X_i,\sh{F})$, we denote by $s_{i|j}$ its restriction to $f^{-1}(W)\cap X_i\cap X_j$, then we set
    \[
      u_W\big((s_i)\big)=(s_{i|j}-s_{j|i})
    \]
    and the compatibility conditions are clearly satisfied.
    To prove that the kernel $\sh{R}$ of $u$ is $f_*(\sh{F})$, we define a homomorphism from $f_*(\sh{F})$ to $\sh{R}$ by sending each section $s\in\Gamma(f^{-1}(W),\sh{F})$ to the family $(s_i)$, where $s_i$ is the restriction of $s$ to $f^{-1}(W)\cap X_i$; axioms (F1) and (F2) of sheaves (G,~II,~1.1) tell us that this homomorphism is \emph{bijective}, which finishes the proof in this case.
  \item[(b)] In the general case, the same reasoning applies once we have established that the $\sh{F}_{ij}$ are quasi-coherent.
    But, by hypothesis, $X_i\cap X_j$ is a finite union of affine opens $X_{ijk}$; and since the $X_{ijk}$ are affine opens \emph{in a scheme}, the intersection of any two of them is again an affine open \sref{I.5.5.6}. We are thus led to the first case, and so we have proved Proposition~\sref{I.9.2.1}.
\end{enumerate}
\end{proof}

\begin{corollary}[9.2.2]
\label{I.9.2.2}
The conclusion of Proposition~\sref{I.9.2.1} holds true in each of the following cases:
\begin{enumerate}
  \item[{\rm(a)}] $f$ is separated and quasi-compact;
  \item[{\rm(b)}] $f$ is separated and of finite type;
  \item[{\rm(c)}] $f$ is quasi-compact, and the underlying space of $X$ is locally Noetherian.
\end{enumerate}
\end{corollary}

\begin{proof}
In case~(a), the $X_{\alpha i}\cap X_{\alpha j}$ are affine \sref{I.5.5.6}.
Case~(b) is a particular example of case~(a) \sref{I.6.6.3}. Finally, in case~(c), we can reduce to the case where $Y$ is affine and the underlying space of $X$ is Noetherian; then $X$ admits a finite cover of affine opens $(X_i)$, and the $X_i\cap X_j$, being quasi-compact, are finite unions of affine opens \sref{I.2.1.3}.
\end{proof}

\subsection{Extension of sections of quasi-coherent sheaves}
\label{subsection:I.9.3}

\begin{theorem}[9.3.1]
\label{I.9.3.1}
Let $X$ be a prescheme whose underlying space is Noetherian, or a scheme whose underlying
space is quasi-compact. Let $\sh{L}$ be an invertible $\sh{O}_X$-module \sref[0]{0.5.4.1}, $f$ a
section of $\sh{L}$ over $X$, $X_f$ the open set of $x\in X$ such that $f(x)\neq0$
\sref[0]{0.5.5.1}, and $\sh{F}$ a quasi-coherent $\sh{O}_X$-module.
\begin{enumerate}
  \item[{\rm(i)}] If $s\in\Gamma(X,\sh{F})$ is such that $s|X_f=0$, then there exists an integer $n>0$ such that $s\otimes f^{\otimes n}=0$.
  \item[{\rm(ii)}] For every section $s\in\Gamma(X_f,\sh{F})$, there exists an integer $n>0$ such that $s\otimes f^{\otimes n}$ extends to a section of $\sh{F}\otimes\sh{L}^{\otimes n}$ over $X$.
\end{enumerate}
\end{theorem}

\begin{proof}
\medskip\noindent
\begin{enumerate}
  \item[(i)] Since the underlying space of $X$ is quasi-compact, and thus the union of
    finitely-many affine opens $U_i$ with $\sh{L}|U_i$ isomorphic to
    $\sh{O}_X|U_i$, we can reduce to the case where $X$ is affine and $\sh{L}=\sh{O}_X$.
    In this case, $f$ can be identified with an element of $A(X)$, and we have that
    $X_f=D(f)$; $s$ can be identified with an element of an $A(X)$-module $M$, and
    $s|X_f$ to the corresponding element of $M_f$, and the result is then trivial,
    recalling the definition of a module of fractions.
\oldpage[I]{173}
  \item[(ii)] Again, $X$ is a finite union of affine opens $U_i$ ($1\leq i\leq r$)
    such that $\sh{L}|U_i\cong\sh{O}_X|U_i$, and, for every $i$,
    $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ can be identified (by the aforementioned
    isomorphism) with $(f|(U_i\cap X_f))^n(s|(U_i\cap X_f))$. We then know
    \sref{I.1.4.1} that there exists an integer $n>0$ such that, for all
    $i$, $(s\otimes f^{\otimes n})|(U_i\cap X_f)$ extends to a section $s_i$ of
    $\sh{F}\otimes\sh{L}^{\otimes n}$ over $U_i$. Let $s_{i|j}$ be the restriction
    of $s_i$ to $U_i\cap U_j$; by definition we have that $s_{i|j}-s_{j|i}=0$ on
    $X_f\cap U_i\cap U_j$. But, if $X$ is a Noetherian space, then $U_i\cap U_j$ is
    quasi-compact; if $X$ is a scheme, then $U_i\cap U_j$ is an affine open
    \sref{I.5.5.6}, and so again quasi-compact. By virtue of (i), there thus
    exists an integer $m$ (independent of $i$ and $j$) such that
    $(s_{i|j}-s_{j|i})\otimes f^{\otimes m}=0$. It immediately follows that there
    exists a section $s'$ of $\sh{F}\otimes\sh{L}^{\otimes(n+m)}$ over $X$ that
    restricts to $s_i\otimes f^{\otimes m}$ over each $U_i$, and restricts to
    $s\otimes f^{\otimes(n+m)}$ over $X_f$.
\end{enumerate}
\end{proof}

The following corollaries give an interpretation of Theorem~\sref{I.9.3.1} in a more
algebraic language:
\begin{corollary}[9.3.2]
\label{I.9.3.2}
With the hypotheses of \sref{I.9.3.1}, consider the graded ring $A_\bullet=\Gamma_\bullet(\sh{L})$
and the graded $A_\bullet$-module $M_*=\Gamma_\bullet(\sh{L},\sh{F})$ \sref[0]{0.5.4.6}. If $f\in A_n$,
where $n\in\bb{Z}$, then there is a canonical isomorphism
$\Gamma(X_f,\sh{F})\isoto((M_*)_f)_0$ (\emph{the subgroup of the module of
fractions $(M_*)_f$ consisting of elements of degree $0$}).
\end{corollary}

\begin{corollary}[9.3.3]
\label{I.9.3.3}
Suppose that the hypotheses of \sref{I.9.3.1} are satisfied, and suppose further that
$\sh{L}=\sh{O}_X$. Then, setting $A=\Gamma(X,\sh{O}_X)$ and $M=\Gamma(X,\sh{F})$, the $A_f$-module
$\Gamma(X_f,\sh{F})$ is canonically isomorphic to $M_f$.
\end{corollary}

\begin{proposition}[9.3.4]
\label{I.9.3.4}
Let $X$ be a Noetherian prescheme, $\sh{F}$ a coherent $\sh{O}_X$-module, and $\sh{J}$ a
coherent sheaf of ideals in $\sh{O}_X$, such that the support of $\sh{F}$ is contained in that
of $\sh{O}_X|\sh{J}$. Then there exists an integer $n>0$ such that $\sh{J}^n\sh{F}=0$.
\end{proposition}

\begin{proof}
Since $X$ is a union of finitely-many affine opens whose rings are Noetherian, we can suppose
that $X$ is affine, given by some Noetherian ring $A$; then $\sh{F}=\widetilde{M}$, where
$M=\Gamma(X,\sh{F})$ is an $A$-module of finite type, and $\sh{J}=\widetilde{\mathfrak{J}}$,
where $\mathfrak{J}=\Gamma(X,\sh{J})$ is an ideal of $A$ (\sref{I.1.4.1} and
\sref{I.1.5.1}). Since $A$ is Noetherian, $\mathfrak{J}$ admits a finite system of
generators $f_i$ ($1\leq i\leq m$). By hypothesis, every section of $\sh{F}$ over
$X$ is zero on each of the $D(f_i)$; if $s_j$ ($1\leq j\leq q$) are sections of
$\sh{F}$ that generate $M$, then there exists an integer $h$, independent of $i$ and $j$,
such that $f_i^h s_j=0$ \sref{I.1.4.1}, whence $f_i^h s=0$ for all $s\in M$. We thus
conclude that, if $n=mh$, then $\mathfrak{J}^n M=0$, and so the corresponding $\sh{O}_X$-module
$\sh{J}^n\sh{F}=\widetilde{\mathfrak{J}^n M}$ \sref{I.1.3.13} is zero.
\end{proof}

\begin{corollary}[9.3.5]
\label{I.9.3.5}
With the hypotheses of \sref{I.9.3.4}, there exists a closed subprescheme $Y$ of $X$,
whose underlying space is the support of $\sh{O}_X/\sh{J}$, such that, if $j:Y\to X$ is the
canonical injection, then $\sh{F}=j_*(j^*(\sh{F}))$.
\end{corollary}

\begin{proof}
First, note that the supports of $\sh{O}_X/\sh{J}$ and $\sh{O}_X/\sh{J}^n$ are the same,
since, if $\sh{J}_x=\sh{O}_x$, then $\sh{J}_x^n=\sh{O}_x$, and we also have that
$\sh{J}_x^n\subset\sh{J}_x$ for all $x\in X$. We can, thanks to \sref{I.9.3.4}, thus
suppose that $\sh{J}\sh{F}=0$; we can then take $Y$ to be the closed subprescheme of $X$
defined by $\sh{J}$, and since $\sh{F}$ is then an $(\sh{O}_X/\sh{J})$-module, the conclusion
follows immediately.
\end{proof}

\subsection{Extension of quasi-coherent sheaves}
\label{subsection:I.9.4}

\begin{env}[9.4.1]
\label{I.9.4.1}
Let
\oldpage[I]{174}
$X$ be a topological space, $\sh{F}$ a sheaf of sets (resp. of groups, of rings) on $X$, $U$
an open subset of $X$, $\psi:U\to X$ the canonical injection, and $\sh{G}$ a subsheaf of
$\sh{F}|U=\psi^*(\sh{F})$. Since $\psi_*$ is left exact, $\psi_*(\sh{G})$ is a subsheaf of
$\psi_*(\psi^*(\sh{F}))$; we denote by $\rho$ the canonical homomorphism
$\sh{F}\to\psi_*(\psi^*(\sh{F}))$ \sref[0]{0.3.5.3}, and we denote by $\overline{\sh{G}}$
the subsheaf $\rho^{-1}(\psi_*(\sh{G}))$ of $\sh{F}$. It follows immediately from the
definitions that, for every open subset $V$ of $X$, $\Gamma(V,\overline{\sh{G}})$ consists of
sections $s\in\Gamma(V,\sh{F})$ whose restriction to $V\cap U$ is a section of $\sh{G}$ over
$V\cap U$. We thus have that $\overline{\sh{G}}|U=\psi^*(\overline{\sh{G}})=\sh{G}$, and that
$\overline{\sh{G}}$ is the \emph{largest} subsheaf of $\sh{F}$ that restricts to $\sh{G}$
over $U$; we say that $\overline{\sh{G}}$ is the \emph{canonical extension} of the subsheaf
$\sh{G}$ of $\sh{F}|U$ to a subsheaf of $\sh{F}$.
\end{env}

\begin{proposition}[9.4.2]
\label{I.9.4.2}
Let $X$ be a prescheme, and $U$ an open subset of $X$ such that the canonical injection
$j:U\to X$ is a quasi-compact morphism \emph{(which will be the case for \emph{all} $U$ if
the underlying space of $X$ is \emph{locally Noetherian}
\sref{I.6.6.4}[i])}. Then:
\begin{enumerate}
  \item[{\rm(i)}] for every quasi-coherent $(\sh{O}_X|U)$-module $\sh{G}$, $j_*(\sh{G})$
    is a quasi-coherent $\sh{O}_X$-module, and $j_*(\sh{G})|U=j^*(j_*(\sh{G}))=\sh{G}$;
  \item[{\rm(ii)}] for every quasi-coherent $\sh{O}_X$-module $\sh{F}$ and every quasi-coherent
    $(\sh{O}_X|U)$-submodule $\sh{G}$, the canonical extension
    $\overline{\sh{G}}$ of $\sh{G}$ \sref{I.9.4.1} is a
    quasi-coherent $\sh{O}_X$-submodule of $\sh{F}$.
\end{enumerate}
\end{proposition}

\begin{proof}
If $j=(\psi,\theta)$ ($\psi$ being the injection $U\to X$ of underlying spaces), then, by
definition, we have that $j_*(\sh{G})=\psi_*(\sh{G})$ for every $(\sh{O}_X|U)$-module $\sh{G}$,
and, further, that $j^*(\sh{H})=\psi^*(\sh{H})=\sh{H}|U$ for every $\sh{O}_X$-module $\sh{H}$,
by definition of the prescheme induced over an open subset. So (i) is thus a particular case
of (\sref{I.9.2.2}[a]); for the same reason, $j_*(j^*(\sh{F}))$ is quasi-coherent, and
since $\overline{\sh{G}}$ is the inverse image of $j_*(\sh{G})$ by the homomorphism
$\rho:\sh{F}\to j_*(j^*(\sh{F}))$, (ii) follows from \sref{I.4.1.1}.
\end{proof}

Note that the hypothesis that the morphism $j:U\to X$ is quasi-compact
holds whenever the open subset $U$ is \emph{quasi-compact} and $X$ is a
\emph{scheme}: indeed, $U$ is then a union of finitely-many affine opens $U_i$,
and, for every affine open $V$ of $X$, $V\cap U_i$ is an affine open \sref{I.5.5.6}, and
thus quasi-compact.

\begin{corollary}[9.4.3]
\label{I.9.4.3}
Let $X$ be a prescheme, and $U$ a quasi-compact open subset of $X$ such that the injection
morphism $j:U\to X$ is quasi-compact. Suppose as well that every quasi-coherent
$\sh{O}_X$-module is the inductive limit of its quasi-coherent $\sh{O}_X$-submodules of finite type
\emph{(which will be the case if $X$ is an \emph{affine scheme})}. Then let $\sh{F}$ be a
quasi-coherent $\sh{O}_X$-module, and $\sh{G}$ a quasi-coherent $(\sh{O}_X|U)$-submodule of $\sh{F}|U$ \emph{of finite type}. Then there exists a quasi-coherent $\sh{O}_X$-submodule $\sh{G}'$ of
$\sh{F}$ \emph{of finite type} such that $\sh{G}'|U=\sh{G}$.
\end{corollary}

\begin{proof}
We have $\sh{G}=\overline{\sh{G}}|U$, and $\overline{\sh{G}}$ is quasi-coherent, from
\sref{I.9.4.2}, so the inductive limit of its quasi-coherent $\sh{O}_X$-submodules
$\sh{H}_\lambda$ of finite type. It follows that $\sh{G}$ is the inductive limit of the
$\sh{H}_\lambda|U$, and thus equal to one of the $\sh{H}_\lambda|U$, since it is of finite
type \sref[0]{0.5.2.3}.
\end{proof}

\begin{remark}[9.4.4]
\label{I.9.4.4}
Suppose that for \emph{every} affine open $U\subset X$, the injection morphism $U\to X$ is
quasi-compact. Then, if the conclusion of \sref{I.9.4.3} holds for every affine open $U$
and for every quasi-coherent $(\sh{O}_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ of finite type, it
follows
\oldpage[I]{175}
that $\sh{F}$ is the inductive limit of its quasi-coherent $\sh{O}_X$-submodules of finite type.
Indeed, for every affine open $U\subset X$, we have that $\sh{F}|U=\widetilde{M}$, where $M$
is an $A(U)$-module, and since the latter is the inductive limit of its quasi-coherent
submodules of finite type, $\sh{F}|U$ is the inductive limit of its $(\sh{O}_X|U)$-submodules of
finite type \sref{I.1.3.9}. But, by hypothesis, each of these submodules is induced on $U$
by a quasi-coherent $\sh{O}_X$-submodule $\sh{G}_{\lambda,U}$ of $\sh{F}$ of finite type. The
finite sums of the $\sh{G}_{\lambda,U}$ are again quasi-coherent $\sh{O}_X$-modules of finite
type, because this is a local property, and the case where $X$ is affine was covered in
\sref{I.1.3.10}; it is clear then that $\sh{F}$ is the inductive limit of these finite
sums, whence our claim.
\end{remark}

\begin{corollary}[9.4.5]
\label{I.9.4.5}
Under the hypotheses of Corollary~\sref{I.9.4.3}, for every quasi-coherent $(\sh{O}_X|U)$-module
$\sh{G}$ of finite type, there exists a quasi-coherent $\sh{O}_X$-module $\sh{G}'$ of finite
type such that $\sh{G}'|U=\sh{G}$.
\end{corollary}

\begin{proof}
Since $\sh{F}=j_*(\sh{G})$ is quasi-coherent \sref{I.9.4.2} and $\sh{F}|U=\sh{G}$, it
suffices to apply Corollary~\sref{I.9.4.3} to $\sh{F}$.
\end{proof}

\begin{lemma}[9.4.6]
\label{I.9.4.6}
Let $X$ be a prescheme, $L$ a well-ordered set, $(V_\lambda)_{\lambda\in L}$ a cover of $X$
by affine opens, and $U$ an open subset of $X$; for all $\lambda\in L$, we set
$W_\lambda=\bigcup_{\mu<\lambda}V_\mu$. Suppose that: (1) for every $\lambda\in L$,
$V_\lambda\cap W_\lambda$ is quasi-compact; and (2) the immersion morphism $U\to X$ is
quasi-compact. Then, for every quasi-coherent $\sh{O}_X$-module $\sh{F}$ and every
quasi-coherent $(\sh{O}_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ \emph{of finite type}, there
exists a quasi-coherent $\sh{O}_X$-submodule $\sh{G}'$ of $\sh{F}$ \emph{of finite type} such
that $\sh{G}'|U=\sh{G}$.
\end{lemma}

\begin{proof}
Let $U_\lambda=U\cup W_\lambda$; we will define a family $(\sh{G}'_\lambda)$ by induction,
where $\sh{G}'_\lambda$ is a quasi-coherent $(\sh{O}_X|U_\lambda)$-submodule of
$\sh{F}|U_\lambda$ of finite type, such that $\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for
$\mu<\lambda$ and $\sh{G}'_\lambda|U=\sh{G}$. The unique $\sh{O}_X$-submodule $\sh{G}'$ of
$\sh{F}$ such that $\sh{G}'|U_\lambda=\sh{G}'$ for all $\lambda\in L$ \sref[0]{0.3.3.1} will then give
us what we want. So suppose that the $\sh{G}'_\mu$ are defined and have the preceding
properties for $\mu<\lambda$; if $\lambda$ does not have a predecessor then we take
$\sh{G}'_\lambda$ to be the unique $(\sh{O}_X|U_\lambda)$-submodule of $\sh{F}|U_\lambda$ such that
$\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ for all $\mu<\lambda$, which is allowed since the $U_\mu$
with $\mu<\lambda$ then form a cover of $U_\lambda$. If, conversely, $\lambda=\mu+1$, then
$U_\lambda=U_\mu\cup V_\mu$, and it suffices to define a quasi-coherent
$(\sh{O}_X|V_\mu)$-submodule $\sh{G}''_\mu$ of $\sh{F}|V_\mu$ of finite type such that
\[
  \sh{G}''_\mu|(U_\mu\cap V_\mu)=\sh{G}'_\mu|(U_\mu\cap V_\mu);
\]
and then to take $\sh{G}'_\lambda$ to be the $(\sh{O}_X|U_\lambda)$-submodule of
$\sh{F}|U_\lambda$ such that $\sh{G}'_\lambda|U_\mu=\sh{G}'_\mu$ and
$\sh{G}'_\lambda|V_\mu=\sh{G}''_\mu$ \sref[0]{0.3.3.1}. But, since $V_\mu$ is affine, the
existence of $\sh{G}''_\mu$ is guaranteed by \sref{I.9.4.3} as soon as we show that
$U_\mu\cap V_\mu$ is quasi-compact; but $U_\mu\cap V_\mu$ is the union of $U\cap V_\mu$ and
$W_\mu\cap V_\mu$, which are both quasi-compact by virtue of the hypotheses.
\end{proof}

\begin{theorem}[9.4.7]
\label{I.9.4.7}
Let $X$ be a prescheme, and $U$ an open subset of $X$. Suppose that one of the following conditions is verified:
\begin{enumerate}
  \item[{\rm(a)}] the underlying space of $X$ is locally Noetherian;
  \item[{\rm(b)}] $X$ is a quasi-compact scheme and $U$ is a quasi-compact open.
\end{enumerate}
Then, for every quasi-coherent $\sh{O}_X$-module $\sh{F}$ and every quasi-coherent
$(\sh{O}_X|U)$-submodule $\sh{G}$ of $\sh{F}|U$ \emph{of finite type}, there exists a
quasi-coherent $\sh{O}_X$-submodule $\sh{G}'$ of $\sh{F}$ \emph{of finite type} such that
$\sh{G}'|U=\sh{G}$.
\end{theorem}

\begin{proof}
Let
\oldpage[I]{176}
$(V_\lambda)_{\lambda\in L}$ be a cover of $X$ by affine opens, with $L$ assumed to be finite
in case (b); since $L$ is equipped with the structure of a well-ordered set, it suffices to
check that the conditions of \sref{I.9.4.6} are satisfied. It is clear in the case of (a),
since the spaces $V_\lambda$ are Noetherian. For case (b), the $V_\lambda\cap\lambda_\mu$ are
affine \sref{I.5.5.6}, and thus quasi-compact, and, since $L$ is finite,
$V_\lambda\cap W_\lambda$ is quasi-compact. Whence the theorem.
\end{proof}

\begin{corollary}[9.4.8]
\label{I.9.4.8}
Under the hypotheses of \sref{I.9.4.7}, for every quasi-coherent $(\sh{O}_X|U)$-module
$\sh{G}$ of finite type, there exists a quasi-coherent $\sh{O}_X$-module $\sh{G}'$ of finite
type such that $\sh{G}'|U=\sh{G}$.
\end{corollary}

\begin{proof}
It suffices to apply \sref{I.9.4.7} to $\sh{F}=j_*(\sh{G})$, which is quasi-coherent
\sref{I.9.4.2} and such that $\sh{F}|U=\sh{G}$.
\end{proof}

\begin{corollary}[9.4.9]
\label{I.9.4.9}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a quasi-compact
scheme. Then every quasi-coherent $\sh{O}_X$-module is the inductive limit of its quasi-coherent
$\sh{O}_X$-submodules of finite type.
\end{corollary}

\begin{proof}
This follows from Theorem~\sref{I.9.4.7} and Remark~\sref{I.9.4.4}.
\end{proof}

\begin{corollary}[9.4.10]
\label{I.9.4.10}
Under the hypotheses of \sref{I.9.4.9}, if a quasi-coherent $\sh{O}_X$-module $\sh{F}$ is
such that every quasi-coherent $\sh{O}_X$-submodule of finite type of $\sh{F}$ is generated by
its sections over $X$, then $\sh{F}$ is generated by its sections over $X$.
\end{corollary}

\begin{proof}
Let $U$ be an affine open neighbourhood of a point $x\in X$, and let $s$ be a
section of $\sh{F}$ over $U$; the $\sh{O}_X$-submodule $\sh{G}$ of $\sh{F}|U$ generated by $s$
is quasi-coherent and of finite type, so there exists a quasi-coherent $\sh{O}_X$-submodule
$\sh{G}'$ of $\sh{F}$ of finite type such that $\sh{G}'|U=\sh{G}$ \sref{I.9.4.7}. By
hypothesis, there thus exists a finite number of sections $t_i$ of $\sh{G}'$ over $X$ and of
sections $a_i$ of $\sh{O}_X$ over a neighbourhood $V\subset U$ of $x$ such that
$s|V=\sum_i a_i(t_i|V)$, which proves the corollary.
\end{proof}

\subsection{Closed image of a prescheme; closure of a subprescheme}
\label{subsection:I.9.5}

\begin{proposition}[9.5.1]
\label{I.9.5.1}
Let $f:X\to Y$ be a morphism of preschemes such that $f_*(\sh{O}_X)$ is a quasi-coherent
$\sh{O}_Y$-module (which will be the case if $f$ is quasi-compact \emph{and}, in addition, either $f$ is separated or $X$ is locally Noetherian \sref{I.9.2.2}). Then there exists a smaller
subprescheme $Y'$ of $Y$ such that $f$ factors through the canonical injection $j:Y'\to Y$
(\emph{or, equivalently \sref{I.4.4.1}, such that the subprescheme $f^{-1}(Y')$ of $X$ is
\emph{identical} to $X$}).
\end{proposition}

More precisely:
\begin{corollary}[9.5.2]
\label{I.9.5.2}
Under the conditions of \sref{I.9.5.1}, let $f=(\psi,\theta)$, and let $\sh{J}$ be the
(quasi-coherent) kernel of the homomorphism $\theta:\sh{O}_Y\to f_*(\sh{O}_X)$. Then the closed
subprescheme $Y'$ of $Y$ defined by $\sh{J}$ satisfies the conditions of \sref{I.9.5.1}.
\end{corollary}

\begin{proof}
Since the functor $\psi^*$ is exact, the canonical factorization
$\theta:\sh{O}_Y\to\sh{O}_Y/\sh{J}\xrightarrow{\theta'}\psi_*(\sh{O}_X)$ gives (\textbf{0},~3.5.4.3)
a factorization
$\theta^\sharp:\psi^*(\sh{O}_Y)\to\psi^*(\sh{O}_Y)/\psi^*(\sh{J})
  \xrightarrow{{\theta'}^\sharp}\sh{O}_X$; since $\theta_x^\sharp$ is a local homomorphism for
every $x\in X$, the same is true of ${\theta_x'}^\sharp$; if we denote by $\psi_0$ the
continuous map $\psi$ considered as a map from $X$ to \erratum[II]{$Y'$}, and by $\theta_0$ the restriction
$\theta'|X':(\sh{O}_Y/\sh{J})|Y'\to\psi_*(\sh{O}_X)|Y'=(\psi_0)_*(\sh{O}_X)$, then we see that
$f_0=(\psi_0,\theta_0)$ is a morphism of preschemes $X\to Y'$ \sref{I.2.2.1} such that
$f=j\circ f_0$. Now, if $Y''$ is
\oldpage[I]{177}
a second closed subprescheme of $Y$, defined by a quasi-coherent sheaf of ideals $\sh{J}'$ of
$\sh{O}_Y$, such that $f$ factors through the injection $j':Y''\to Y$, then we should
immediately have that $\psi(X)\subset Y''$, and thus that $Y'\subset Y''$, since $Y''$ is closed.
Furthermore, for all $y\in Y''$, $\theta$ should factor as
$\sh{O}_y\to\sh{O}_y/\sh{J}'_y\to(\psi_*(\sh{O}_X))_y$, which, by definition, leads to
$\sh{J}'_y\subset\sh{J}_y$, and thus $X'$ is a closed subprescheme of $Y''$
\sref{I.4.1.10}.
\end{proof}

\begin{definition}[9.5.3]
\label{I.9.5.3}
Whenever there exists a smaller subprescheme $Y'$ of $Y$ such that $f$ factors
through the canonical injection $j:Y'\to Y$, we say that $Y'$ is the
\emph{closed image} prescheme of $X$ under the morphism $f$.
\end{definition}

\begin{proposition}[9.5.4]
\label{I.9.5.4}
If $f_*(\sh{O}_X)$ is a quasi-coherent $\sh{O}_Y$-module, then the underlying space of
the closed image of $X$ under $f$ is the closure $\overline{f(X)}$ in $Y$.
\end{proposition}

\begin{proof}
As the support of $f_*(\sh{O}_X)$ is contained in $\overline{f(X)}$, we have (with
the notation of \sref{I.9.5.2}) $\sh{J}_y=\sh{O}_y$ for
$y\not\in\overline{f(X)}$, thus the support of $\sh{O}_Y/\sh{J}$ is contained in
$\overline{f(X)}$. In addition, this support is closed and contains $f(X)$:
indeed, if $y\in f(X)$, the unit element of the ring $(\psi_*(\sh{O}_X))_y$ is not
zero, being the germ at $y$ of the section
\[
  1\in\Gamma(X,\sh{O}_X)=\Gamma(Y,\psi_*(\sh{O}_X));
\]
since it is the image under $\theta$ of the unit element of $\sh{O}_y$, the latter
does not belong to $\sh{J}_y$, hence $\sh{O}_y/\sh{J}_y\neq 0$; this finishes the
proof.
\end{proof}

\begin{proposition}[9.5.5]
\label{I.9.5.5}
\emph{(Transitivity of closed images)}. Let $f:X\to Y$ and $g:Y\to Z$ be two morphisms of
preschemes; we suppose that the closed image $Y'$ of $X$ under $f$ exists, and that, if $g'$
is the restriction of $g$ to $Y'$, then the closed image $Z'$ of $Y'$ under $g'$ exists. Then
the closed image of $X$ under $g\circ f$ exists and is equal to $Z'$.
\end{proposition}

\begin{proof}
It suffices \sref{I.9.5.1} to show that $Z'$ is the smallest closed
subprescheme $Z_1$ of $Z$ such that the closed subprescheme $(g\circ f)^{-1}(Z_1)$ of $X$
(equal to $f^{-1}(g^{-1}(Z_1))$ by Corollary~\sref{I.4.4.2}) is equal to
$X$; it is equivalent to say that $Z'$ is the smallest closed subprescheme of $Z$ such that
$f$ factors through the injection $g^{-1}(Z_1)\to Y$ \sref{I.4.4.1}. By
virtue of the existence of the closed image $Y'$, every $Z_1$ with this property is such
that $g^{-1}(Z_1)$ factors through $Y'$, which is equivalent to saying that $j^{-1}(g^{-1}(Z_1))=g'^{-1}(Z_1)=Y'$, denoting by $j$ the injection $Y'\to Y$.
By the definition of $Z'$, we indeed conclude that $Z'$ is the smallest closed
subprescheme of $Z$ satisfying the preceding condition.
\end{proof}

\begin{corollary}[9.5.6]
\label{I.9.5.6}
Let $f:X\to Y$ be an $S$-morphism such that $Y$ is the closed image of $X$ under $f$.
Let $Z$ be an $S$-scheme; if two $S$-morphisms $g_1$, $g_2$ from $Y$ to $Z$ are such that $g_1\circ f=g_2\circ f$, then $g_1=g_2$.
\end{corollary}

\begin{proof}
Let $h=(g_1,g_2)_S:Y\to Z\times_S Z$; since the diagonal $T=\Delta_Z(Z)$ is a closed subprescheme of $Z\times_S Z$, $Y'=h^{-1}(T)$ is a closed subprescheme of $Y$ \sref{I.4.4.1}.
Let $u=g_1\circ f=g_2\circ f$; we then have, by definition of the product, $h'=h\circ f=(u,u)_S$, so $h\circ f=\Delta_Z\circ u$; since $\Delta_Z^{-1}(T)=Z$, we have $h'^{-1}(T)=u^{-1}(Z)=X$, so $f^{-1}(Y')=X$.
From this, we conclude \sref{I.4.4.1} that the $f$ factors through the canonical injection $Y'\to Y$, so $Y'=Y$ by hypothesis; it then follows \sref{I.4.4.1} that $h$ factors as $\Delta_Z\circ v$, where $v$ is a morphism $Y\to Z$, which implies that $g_1=g_2=v$.
\end{proof}

\begin{remark}[9.5.7]
\label{I.9.5.7}
If $X$ and $Y$ are $S$-schemes, Proposition~\sref{I.9.5.6} implies that, when
\oldpage[I]{178}
$Y$ is the closed image of $X$ under $f$, $f$ is an \emph{epimorphism} in the category of \emph{$S$-schemes} (T,~1.1).
We will show in Chapter~V that, conversely, if the closed image $Y'$ of $X$ under $f$ exists and if $f$ is an epimorphism of $S$-schemes, then we necessarily have that $Y'=Y$.
\end{remark}

\begin{proposition}[9.5.8]
\label{I.9.5.8}
Suppose that the hypotheses of \sref{I.9.5.1} are satisfied, and let $Y'$ be the closed image of $X$ under $f$.
For every open $V$ of $Y$, let $f_V:f^{-1}(V)\to V$ be the restriction of $f$; then the closed image of $f^{-1}(V)$ under $f_V$ in $V$ exists and is equal to the prescheme induced by $Y'$ on the open $V\cap Y'$ of $Y'$ \emph{(in other words, to the subprescheme $\inf(V,Y)$ of $Y$ \sref{I.4.4.3})}.
\end{proposition}

\begin{proof}
Let $X'=f^{-1}(V)$; since the direct image of $\sh{O}_{X'}$ by $f_V$ is exactly the restriction of $f_*(\sh{O}_X)$ to $V$, it is clear that the kernel $\sh{J}'$ of the homomorphism $\sh{O}_V\to(f_V)_*(\sh{O}_{X'})$ is the restriction of $\sh{J}$ to $V$, from which the proposition quickly follows.
\end{proof}

We will see that this result can be understood as saying that taking the closed image commutes with an extension $Y_1\to Y$ of the base prescheme, which is an \emph{open immersion}.
We will see in Chapter~IV that it is the same for an extension $Y_1\to Y$ which is a \emph{flat} morphism, provided that $f$ is separated and quasi-compact.

\begin{proposition}[9.5.9]
\label{I.9.5.9}
Let $f:X\to Y$ be a morphism such that the closed image $Y'$ of $X$ under $f$ exists.
\begin{enumerate}
  \item[{\rm(i)}] If $X$ is reduced, then so too is $Y'$.
  \item[{\rm(ii)}] If the hypotheses of Proposition~\sref{I.9.5.1} are satisfied and $X$ is irreducible (resp. integral), then so too is $Y'$.
\end{enumerate}
\end{proposition}

\begin{proof}
By hypothesis, the morphism $f$ factors as $X\xrightarrow{g}Y'\xrightarrow{j}Y$, where $j$ is the canonical injection.
Since $X$ is reduced, $g$ factors as $X\xrightarrow{h}Y'_\red\xrightarrow{j'}Y'$, where $j'$ is the canonical injection \sref{I.5.2.2}, and it then follows from the definition of $Y'$ that $Y'_\red=Y'$.
If, moreover, the conditions of Proposition~\sref{I.9.5.1} are satisfied, then it follows from \sref{I.9.5.4} that $f(X)$ is dense in $Y'$; if $X$ is irreducible, then so is $Y'$ \sref[0]{0.2.1.5}.
The claim about integral preschemes follows from the conjunction of the two others.
\end{proof}

\begin{proposition}[9.5.10]
\label{I.9.5.10}
Let $Y$ be a subprescheme of a prescheme $X$, such that the canonical injection $i:Y\to X$ is a quasi-compact morphism.
Then there exists a smaller closed subprescheme $\overline{Y}$ of $X$ containing $Y$; its underlying space is the closure of that of $Y$; the latter is open in its closure, and the prescheme $Y$ is induced on this open by $\overline{Y}$.
\end{proposition}

\begin{proof}
It suffices to apply Proposition~\sref{I.9.5.1} to the injection $j$, which is separated \sref{I.5.5.1} and quasi-compact by hypothesis; \sref{I.9.5.1} thus proves the existence of $\overline{Y}$, and \sref{I.9.5.4} shows that its underlying space is the closure of $Y$ in $X$; since $Y$ is locally closed in $X$, it is open in $\overline{Y}$, and the last claim comes from \sref{I.9.5.8} applied to an open subset $V$ of $X$ such that $Y$ is closed in $V$.
\end{proof}

With the above notation, if the injection $V\to X$ is quasi-compact, and if $\sh{J}$ is the quasi-coherent sheaf of ideals of $\sh{O}_X|V$ defining the closed subprescheme $Y$ of $V$, it follows from Proposition~\sref{I.9.5.1} that the quasi-coherent sheaf of ideals of $\sh{O}_X$ defining $\overline{Y}$ is the canonical extension \sref{I.9.4.1} $\overline{\sh{J}}$ of $\sh{J}$, because it is clearly the largest quasi-coherent subsheaf of ideals of $\sh{O}_X$ inducing $\sh{J}$ on $V$.

\begin{corollary}[9.5.11]
\label{I.9.5.11}
Under
\oldpage[I]{179}
the hypotheses of Proposition~\sref{I.9.5.10}, every section of $\sh{O}_{\overline{Y}}$ over an open $V$ of $\overline{Y}$ that is zero on $V\cap Y$ is zero.
\end{corollary}

\begin{proof}
By Proposition~\sref{I.9.5.8}, we can reduce to the case where $V=\overline{Y}$.
If we take into account that the sections of $\sh{O}_{\overline{Y}}$ over $\overline{Y}$ canonically correspond to the $\overline{Y}$-sections of $\overline{Y}\otimes_Z Z[T]$ \sref{I.3.3.15} and that the latter is separated over $\overline{Y}$, then the corollary appears as a specific case of \sref{I.9.5.6}.
\end{proof}

When there exists a smaller closed subprescheme $Y'$ of $X$ containing a subprescheme $Y$ of $X$, we say that $Y'$ is the \emph{closure} of $Y$ in $X$, when there is little cause for confusion.

\subsection{Quasi-coherent sheaves of algebras; change of structure sheaf}
\label{subsection:I.9.6}

\begin{proposition}[9.6.1]
\label{I.9.6.1}
Let $X$ be a prescheme, and $\sh{B}$ a quasi-coherent $\sh{O}_X$-algebra \sref[0]{0.5.1.3}.
For a $\sh{B}$-module $\sh{F}$ to be quasi-coherent (on the ringed space $(X,\sh{B})$) it is necessary and sufficient that $\sh{F}$ be a quasi-coherent $\sh{O}_X$-module.
\end{proposition}

\begin{proof}
Since the question is local, we can assume $X$ to be affine, given by some ring $A$, and thus $\sh{B}=\widetilde{B}$, where $B$ is an $A$-algebra \sref{I.1.4.3}.
If $\sh{F}$ is quasi-coherent on the ringed space $(X,\sh{B})$ then we can also assume that $\sh{F}$ is the cokernel of a $\sh{B}$-homomorphism $\sh{B}^{(I)}\to\sh{B}^{(J)}$; since this homomorphism is also an $\sh{O}_X$-homomorphism of $\sh{O}_X$-modules, and $\sh{B}^{(I)}$ and $\sh{B}^{(J)}$ are quasi-coherent $\sh{O}_X$-modules \sref{I.1.3.9}[ii], $\sh{F}$ is also a quasi-coherent $\sh{O}_X$-module \sref{I.1.3.9}[i].

Conversely, if $\sh{F}$ is a quasi-coherent $\sh{O}_X$-module, then $\sh{F}=\widetilde{M}$, where $M$ is a $B$-module \sref{I.1.4.3}; $M$ is isomorphic to the cokernel of a $B$-homomorphism $B^{(I)}\to B^{(J)}$, so $\sh{F}$ is a $\sh{B}$-module isomorphic to the cokernel of the corresponding homomorphism $\sh{B}^{(I)}\to\sh{B}^{(J)}$ \sref{I.1.3.13}, which finishes the proof.
\end{proof}

In particular, if $\sh{F}$ and $\sh{G}$ are two quasi-coherent $\sh{B}$-modules, then $\sh{F}\otimes_{\sh{B}}\sh{G}$ is a quasi-coherent $\sh{B}$-module; similarly for $\shHom(\sh{F},\sh{G})$ whenever we further suppose that $\sh{F}$ admits a finite presentation \sref{I.1.3.13}.

\begin{env}[9.6.2]
\label{I.9.6.2}
Given a prescheme $X$, we say that a quasi-coherent $\sh{O}_X$-algebra $\sh{B}$ is of \emph{finite type} if, for all $x\in X$, there exists an open \emph{affine} neighbourhood $U$ of $x$ such that $\Gamma(U,\sh{B})=B$ is an algebra of finite type over $\Gamma(U,\sh{O}_X)=A$.
We then have that $\sh{B}|U=\widetilde{B}$ and, for all $f\in A$, the induced $(\sh{O}_X|D(f))$-algebra $\sh{B}|D(f)$ is of finite type, because it is isomorphic to $(B_f)^{\sim}$, and $B_f=B\otimes_A A_f$ is clearly an algebra of finite type over $A_f$.
Since the $D(f)$ form a basis for the topology of $U$, we thus conclude that if $\sh{B}$ is a quasi-coherent $\sh{O}_X$-algebra of finite type then, for every open $V$ of $X$, $\sh{B}|V$ is a quasi-coherent $(\sh{O}_X|V)$-algebra of finite type.
\end{env}

\begin{proposition}[9.6.3]
\label{I.9.6.3}
Let $X$ be a locally Noetherian prescheme.
Then every quasi-coherent $\sh{O}_X$-algebra $\sh{B}$ of finite type is a coherent sheaf of rings \sref[0]{0.5.3.7}.
\end{proposition}

\begin{proof}
We can once again restrict to the case where $X$ is an affine scheme given by a Noetherian ring $A$, and where $\sh{B}=\widetilde{B}$, with $B$ being an $A$-algebra of finite type; $B$ is then a Noetherian ring.
With this, it remains to prove that the kernel $\sh{N}$ of a $\sh{B}$-homomorphism $\sh{B}^m\to\sh{B}$ is a $\sh{B}$-module
\oldpage[I]{180}
of finite type; but it is isomorphic (as a $\sh{B}$-module) to $\widetilde{N}$, where $N$ is the kernel of the corresponding homomorphism of $B$-modules $B^m\to B$ \sref{I.1.3.13}.
Since $B$ is Noetherian, the submodule $N$ of $B^m$ is a $B$-module of finite type, so there exists a homomorphism $B^p\to B^m$ with image $N$; since the sequence $B^p\to B^m\to B$ is exact, so too is the corresponding sequence $\sh{B}^p\to\sh{B}^m\to\sh{B}$ \sref{I.1.3.5}, and since $\sh{N}$ is the image of $\sh{B}^p\to\sh{B}^m$ \sref{I.1.3.9}[i], this proves the proposition.
\end{proof}

\begin{corollary}[9.6.4]
\label{I.9.6.4}
Under the hypotheses of \sref{I.9.6.3}, for a $\sh{B}$-module $\sh{F}$ to be coherent, it is necessary and sufficient that it be a quasi-coherent $\sh{O}_X$-module and a $\sh{B}$-module of finite type.
If this is the case, and if $\sh{G}$ is a $\sh{B}$-submodule or a quotient module of $\sh{F}$, then in order for $\sh{G}$ to be a coherent $\sh{B}$-module, it is necessary and sufficient that it be a quasi-coherent $\sh{O}_X$-module.
\end{corollary}

\begin{proof}
Taking \sref{I.9.6.1} into account, the conditions on $\sh{F}$ are clearly necessary; we will show that they are sufficient.
We can restrict to the case where $X$ is affine, given by some Noetherian ring $A$, where $\sh{B}=\widetilde{B}$, with $B$ an $A$-algebra of finite type, where $\sh{F}=\widetilde{M}$, with $M$ a $B$-module, and where there exists a surjective $\sh{B}$-homomorphism $\sh{B}^m\to\sh{F}\to0$.
We then have the corresponding exact sequence $B^m\to M\to0$, so $M$ is a $B$-module of finite type; further, the kernel $P$ of the homomorphism $B^m\to M$ is then a $B$-module of finite type, since $B$ is Noetherian.
We thus conclude \sref{I.1.3.13} that $\sh{F}$ is the cokernel of a $\sh{B}$-homomorphism $\sh{B}^m\to\sh{B}^n$, and is thus coherent, since $\sh{B}$ is a coherent sheaf of rings \sref[0]{0.5.3.4}.
The same reasoning shows that a quasi-coherent $\sh{B}$-submodule (resp. a quotient $\sh{B}$-module) of $\sh{F}$ is of finite type, from whence the second part of the corollary.
\end{proof}

\begin{proposition}[9.6.5]
\label{I.9.6.5}
Let $X$ be a quasi-compact scheme, or a prescheme whose underlying space is Noetherian.
For all quasi-compact $\sh{O}_X$-algebras $\sh{B}$ of finite type, there exists a quasi-coherent $\sh{O}_X$-submodule $\sh{E}$ of $\sh{B}$ of finite type such that $\sh{E}$ generates \sref[0]{0.4.1.3} the $\sh{O}_X$-algebra $\sh{B}$.
\end{proposition}

\begin{proof}
In fact, by hypothesis, there exists a finite cover $(U_i)$ of $X$ consisting of affine opens such that $\Gamma(U_i,\sh{B})=B_i$ is an algebra of finite type over $\Gamma(U_i,\sh{O}_X)=A_i$; let $E_i$ be a $A_i$-submodule of $B_i$ of finite type that generates the $A_i$-algebra $B_i$; thanks to \sref{I.9.4.7}, there exists a $\sh{O}_X$-submodule $\sh{E}_i$ of $\sh{B}$, quasi-coherent and of finite type, such that $\sh{E}_i|U_i=\widetilde{E_i}$.
It is clear that the sum $\sh{E}$ of the $\sh{E}_i$ is the desired object.
\end{proof}

\begin{proposition}[9.6.6]
\label{I.9.6.6}
Let $X$ be a prescheme whose underlying space is locally Noetherian, or a quasi-compact scheme.
Then every quasi-coherent $\sh{O}_X$-algebra $\sh{B}$ is the inductive limit of its quasi-coherent $\sh{O}_X$-subalgebras of finite type.
\end{proposition}

\begin{proof}
In fact, it follows from \sref{I.9.4.9} that $\sh{B}$ is the inductive limit (as an $\sh{O}_X$-module) of its quasi-coherent $\sh{O}_X$-submodules of finite type; the latter generating quasi-coherent \emph{$\sh{O}_X$-subalgebras} of $\sh{B}$ of finite type \sref{I.1.3.14}, and so $\sh{B}$ is \emph{a fortiori} their inductive limit.
\end{proof}

